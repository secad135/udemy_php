# جزوه آموزشی PHP: دریافت داده از URL با استفاده از Query String و $_GET

---

## 🎯 هدف درس

در این بخش یاد می‌گیریم که چگونه شناسه‌ی هر مقاله (id) را از طریق **آدرس URL** به اسکریپت PHP ارسال کنیم تا بتوانیم مقالات پویا بسازیم. برای این کار از **Query String** و متغیر سراسری **`$_GET`** استفاده می‌کنیم.

---

## 📘 مفهوم Query String

Query String (رشته‌ی پرس‌وجو) بخشی از آدرس وب است که پس از علامت سؤال `?` قرار می‌گیرد و داده‌ها را به اسکریپت می‌فرستد.

**مثال:**

```
article.php?id=3
```

در اینجا:

* `id` نام متغیر است.
* `3` مقدار آن است.

---

## 🧩 Super Globalها در PHP

PHP چند متغیر سراسری دارد که همیشه و در همه‌جا در دسترس‌اند. برای کار با Query String، دو مورد مهم‌اند:

1. **`$_SERVER`** — شامل اطلاعات مربوط به درخواست (Request) فعلی است. یکی از کلیدهای آن `QUERY_STRING` است.
2. **`$_GET`** — آرایه‌ای انجمنی است که تمام متغیرهای موجود در Query String را به‌صورت کلید و مقدار در خود ذخیره می‌کند.

---

## 🧪 مثال: فایل `querystring.php`

```php
<?php

var_dump($_SERVER["QUERY_STRING"]);
var_dump($_GET);
```

اگر در مرورگر بنویسیم:

```
querystring.php?id=1&name=Ali
```

خروجی:

```php
string(10) "id=1&name=Ali"
array(2) {
  ["id"]=> string(1) "1"
  ["name"]=> string(3) "Ali"
}
```

🔹 توجه کنید: تمام مقادیر به صورت رشته (string) ذخیره می‌شوند، حتی اگر عدد باشند.

---

## 🧱 نمایش لیست مقالات در `index.php`

در این فایل فهرست مقالات را از پایگاه داده می‌گیریم و برای هر مقاله لینکی به `article.php` می‌سازیم تا شناسه‌ی آن در Query String ارسال شود.

```php
<?php

$db_host = "localhost";
$db_name = "cms";
$db_user = "cms_www";
$db_pass = "64w6H2rOJ1zwLRyk";

$conn = mysqli_connect($db_host, $db_user, $db_pass, $db_name);

if (mysqli_connect_error()) {
    echo mysqli_connect_error();
    exit;
}

$sql = "SELECT * FROM article ORDER BY published_at;";
$results = mysqli_query($conn, $sql);

if ($results === false) {
    echo mysqli_error($conn);
} else {
    $articles = mysqli_fetch_all($results, MYSQLI_ASSOC);
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>My blog</title>
    <meta charset="utf-8">
</head>
<body>
<header>
    <h1>My blog</h1>
</header>
<main>
<?php if (empty($articles)): ?>
    <p>No articles found.</p>
<?php else: ?>
    <ul>
        <?php foreach ($articles as $article): ?>
            <li>
                <article>
                    <h2><a href="article.php?id=<?= $article['id']; ?>"><?= $article['title']; ?></a></h2>
                    <p><?= $article['content']; ?></p>
                </article>
            </li>
        <?php endforeach; ?>
    </ul>
<?php endif; ?>
</main>
</body>
</html>
```

🔹 در خط لینک، مقدار `id` هر مقاله در Query String قرار می‌گیرد.

---

## 📄 نمایش مقاله تکی در `article.php`

در این فایل با استفاده از `$_GET['id']` شناسه‌ی مقاله را از آدرس می‌گیریم و مقاله‌ی مربوطه را از پایگاه داده نمایش می‌دهیم.

```php
<?php

$db_host = "localhost";
$db_name = "cms";
$db_user = "cms_www";
$db_pass = "64w6H2rOJ1zwLRyk";

$conn = mysqli_connect($db_host, $db_user, $db_pass, $db_name);

if (mysqli_connect_error()) {
    echo mysqli_connect_error();
    exit;
}

$sql = "SELECT * FROM article WHERE id = " . $_GET['id'];
$results = mysqli_query($conn, $sql);

if ($results === false) {
    echo mysqli_error($conn);
} else {
    $article = mysqli_fetch_assoc($results);
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>My blog</title>
    <meta charset="utf-8">
</head>
<body>
<header>
    <h1>My blog</h1>
</header>
<main>
<?php if ($article === null): ?>
    <p>Article not found.</p>
<?php else: ?>
    <article>
        <h2><?= $article['title']; ?></h2>
        <p><?= $article['content']; ?></p>
    </article>
<?php endif; ?>
</main>
</body>
</html>
```

🔹 حالا اگر در مرورگر بنویسیم:

```
article.php?id=1
```

مقاله‌ای با شناسه‌ی ۱ نمایش داده می‌شود. اگر عدد را تغییر دهیم، مقاله‌ی دیگری بارگذاری خواهد شد.

---

## 🔗 ارتباط بین صفحات

اکنون:

* `index.php` → فهرست مقالات را نشان می‌دهد و لینک به هر مقاله دارد.
* `article.php` → شناسه‌ی مقاله را از URL می‌گیرد و محتوای آن را نمایش می‌دهد.

هر لینک به همان فایل اشاره دارد اما شناسه‌ی متفاوتی ارسال می‌کند:

```
article.php?id=1
article.php?id=2
article.php?id=3
```

---

## ⚠️ نکته امنیتی

استفاده مستقیم از `$_GET['id']` در کوئری SQL می‌تواند باعث **SQL Injection** شود. در عمل باید از **Prepared Statement** یا تابع `mysqli_real_escape_string()` برای پاک‌سازی ورودی‌ها استفاده شود.

---

## 📚 منابع

* [PHP Manual: Superglobals](https://www.php.net/manual/en/language.variables.superglobals.php)
* [PHP Manual: $_GET](https://www.php.net/manual/en/reserved.variables.get.php)

---

✅ با اجرای این مراحل اکنون وب‌سایت شما می‌تواند هر مقاله را از طریق شناسه‌ی موجود در URL واکشی و نمایش دهد.
