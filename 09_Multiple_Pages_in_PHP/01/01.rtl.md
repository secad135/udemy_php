# جزوه: ایجاد صفحه نمایش مقاله تکی در PHP و MySQL

---

## مقدمه

در پروژه‌های مبتنی بر PHP که از پایگاه داده MySQL استفاده می‌کنند، معمولاً صفحه‌ی اصلی (`index.php`) فهرستی از همه‌ی مقالات یا داده‌ها را نمایش می‌دهد. در این بخش یاد می‌گیریم که چگونه یک صفحه‌ی جدید به نام `article.php` بسازیم تا **یک مقاله‌ی خاص** را به‌صورت جداگانه نمایش دهد.

---

## گام اول: ایجاد فایل جدید

در ابتدا:

* فایل `index.php` را **کپی** کرده و نام آن را به **`article.php`** تغییر می‌دهیم.
* هدف این فایل نمایش جزئیات فقط یک مقاله است.

---

## گام دوم: ویرایش کوئری SQL

در `index.php` کوئری SQL تمام مقالات را انتخاب می‌کند:

```php
$sql = "SELECT * FROM article ORDER BY published_at;";
```

اما در فایل `article.php` می‌خواهیم فقط **یک مقاله** را نمایش دهیم. بنابراین باید از شرط `WHERE` استفاده کنیم تا رکورد خاصی را انتخاب کنیم:

```php
$sql = "SELECT * FROM article WHERE id = 1;";
```

> 🔹 در ابتدا می‌توانیم مقدار `id` را به صورت **hard-coded** قرار دهیم (مثلاً `1`) تا عملکرد را آزمایش کنیم.

---

## گام سوم: واکشی فقط یک سطر از نتیجه

در صفحه‌ی اصلی از `mysqli_fetch_all()` استفاده شده است تا تمام رکوردها گرفته شوند:

```php
$articles = mysqli_fetch_all($results, MYSQLI_ASSOC);
```

اما در این صفحه فقط یک مقاله لازم داریم. پس باید از تابع `mysqli_fetch_assoc()` استفاده کنیم که فقط **یک رکورد** را به‌صورت آرایه‌ی انجمنی (associative array) برمی‌گرداند:

```php
$article = mysqli_fetch_assoc($results);
```

---

## گام چهارم: حذف حلقه‌ی foreach

از آنجا که فقط یک مقاله داریم، نیازی به حلقه نیست. بنابراین کد بخش HTML باید تغییر کند تا مستقیماً داده‌ی همان مقاله را چاپ کند:

```php
<?php if ($article): ?>
    <article>
        <h2><?= $article['title']; ?></h2>
        <p><?= $article['content']; ?></p>
    </article>
<?php else: ?>
    <p>Article not found.</p>
<?php endif; ?>
```

---

## گام پنجم: بررسی وجود نداشتن مقاله

اگر مقاله‌ای با آن شناسه (`id`) وجود نداشته باشد، تابع `mysqli_fetch_assoc()` مقدار `null` برمی‌گرداند. در این صورت باید پیغام خطای مناسب نمایش دهیم:

```php
if ($article === null) {
    echo "Article not found.";
}
```

---

## کد نهایی فایل `article.php`

```php
<?php

$db_host = "localhost";
$db_name = "cms";
$db_user = "cms_www";
$db_pass = "64w6H2rOJ1zwLRyk";

$conn = mysqli_connect($db_host, $db_user, $db_pass, $db_name);

if (mysqli_connect_error()) {
    echo mysqli_connect_error();
    exit;
}

$sql = "SELECT * FROM article WHERE id = 1;"; // نمایش مقاله با شناسه 1

$results = mysqli_query($conn, $sql);

if ($results === false) {
    echo mysqli_error($conn);
} else {
    $article = mysqli_fetch_assoc($results);
}
?>
<!DOCTYPE html>
<html>
<head>
    <title>My blog</title>
    <meta charset="utf-8">
</head>
<body>

    <header>
        <h1>My blog</h1>
    </header>

    <main>
        <?php if ($article): ?>
            <article>
                <h2><?= $article['title']; ?></h2>
                <p><?= $article['content']; ?></p>
            </article>
        <?php else: ?>
            <p>Article not found.</p>
        <?php endif; ?>
    </main>

</body>
</html>
```

---

## نکات مهم

* استفاده از `WHERE id = ?` پایه‌ی ایجاد صفحات پویا برای نمایش مقالات بر اساس شناسه است.
* تابع `mysqli_fetch_assoc()` برای واکشی یک سطر استفاده می‌شود.
* اگر رکوردی با آن شناسه وجود نداشته باشد، باید پیغام مناسبی به کاربر نشان دهیم.
* در مراحل بعد می‌توان شناسه مقاله را از **پارامتر GET** در URL دریافت کرد تا صفحه کاملاً پویا شود.

---

✅ **نتیجه:**
اکنون صفحه‌ی `article.php` فقط یک مقاله خاص را از پایگاه داده واکشی و نمایش می‌دهد و در صورت عدم وجود مقاله، پیغام خطا نشان می‌دهد.
